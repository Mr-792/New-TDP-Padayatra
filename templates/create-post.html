{% load static %}
<!doctype html>
<html lang="en">

<head>
        
        <meta charset="utf-8" />
        <title>TDP | Padayatra</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta content="Premium Multipurpose Admin & Dashboard Template" name="description" />
        <meta content="Themesbrand" name="author" />
        <!-- App favicon -->
        <link rel="shortcut icon" href="{% static 'assets/images/logo-dark.png' %}">
		   
        <!-- Bootstrap Css -->
        <link href="{% static 'assets/css/bootstrap.min.css' %}" id="bootstrap-style" rel="stylesheet" type="text/css" />
        <!-- Icons Css -->
        <link href="{% static 'assets/css/icons.min.css' %}" rel="stylesheet" type="text/css" />
        <!-- App Css-->
        <link href="{% static 'assets/css/app.min.css' %}" id="app-style" rel="stylesheet" type="text/css" />
		  <link href="{% static 'assets/libs/select2/css/select2.min.css' %}" rel="stylesheet" type="text/css" />
			<link  href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-tagsinput/0.8.0/bootstrap-tagsinput.css" rel="stylesheet"/>
			<style>
			#editor {
	resize: vertical;
	overflow: auto;
	line-height: 1.5;
	background-color: #fff;
	background-image: none;
	background-color: #fff;
    border: 1px solid #ccc;
	border-radius: 4px;
	min-height: 150px;
	box-shadow: none;
	padding: 8px 16px;
	margin: 0 auto;
	font-size: 14px;
	transition: border-color 0.15s ease-in-out 0s, box-shadow 0.15s ease-in-out 0s;
}
	#editor:focus {
		background-color: #f0f0f0;
		border-color: #38af5b;
		box-shadow: none;
		outline: 0 none;
	}
	.title h1, .title h2, .title h3, .title h4 { margin: 5px; }
.title {
    position: relative;
    display: block;
    padding-bottom: 0;
    border-bottom: 3px double #dcdcdc;
    margin-bottom: 30px;
}
	.title::before {
		width: 15%;
		height: 3px;
		background: #53bdff;
		position: absolute;
		bottom: -3px;
		content:'';
	}
	
	#editparent .btn {
  font-family:"Raleway", sans-serif;
  font-weight: 300;
  font-size: 1em;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  border: none;
  border-bottom: .15em solid black;
  padding: 0.65em 1.3em;
}
#editparent .btn-xs {
	font-size: .80em;
	padding: .25em .75em;
}

#editparent .btn-default {
  border-color: #d9d9d9;
  background-image: linear-gradient(#ffffff, #f2f2f2);
}
	#editparent .btn-default:hover { background: linear-gradient(#f2f2f2, #e6e6e6); }
	
	#editparent  a {
    color: #000;
    text-decoration: none;
    outline: 0;
}
	#editparent  a:hover {
		color: #06a0ff;
		text-decoration: none;
	}
#editparent  p { margin: 10px 0; }
			</style>
    </head>

    <body data-layout="horizontal" data-topbar="colored" data-layout-size="boxed">

        <!-- Begin page -->
        <div id="layout-wrapper">

            <header id="page-topbar">
                <div class="navbar-header">
                    <div class="d-flex">
                        <!-- LOGO -->
                        <div class="navbar-brand-box">
                            <a href="#" class="logo logo-dark">
                                <span class="logo-sm">
                                    <img src="{% static 'assets/images/logo-dark.png' %}" alt="" height="68">
                                </span>
                                <span class="logo-lg">
                                    <img src="{% static 'assets/images/logo-dark.png' %}" alt="" height="68">
                                </span>
                            </a>

                            <a href="#" class="logo logo-light">
                                <span class="logo-sm">
                                    <img src="{% static 'assets/images/logo-dark.png' %}" alt="" height="68">
                                </span>
                                <span class="logo-lg">
                                    <img src="{% static 'assets/images/logo-dark.png' %}" alt="" height="68">
                                </span>
                            </a>
                        </div>

                        <button type="button" class="btn btn-sm px-3 font-size-16 d-lg-none header-item waves-effect waves-light" data-bs-toggle="collapse" data-bs-target="#topnav-menu-content">
                            <i class="fa fa-fw fa-bars"></i>
                        </button>

                        <!-- App Search-->
                        <form class="app-search d-none d-lg-block">
                            <div class="position-relative">
                                <input type="text" class="form-control" placeholder="Search...">
                                <span class="uil-search"><i class="fas fa-search"></i></span>
                            </div>
                        </form>
                    </div>

                    <div class="d-flex">

                        <div class="dropdown d-inline-block d-lg-none ms-2">
                            <button type="button" class="btn header-item noti-icon waves-effect" id="page-header-search-dropdown"
                                data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <i class="fas fa-search"></i>
                            </button>
                            <div class="dropdown-menu dropdown-menu-lg dropdown-menu-end p-0"
                                aria-labelledby="page-header-search-dropdown">
                    
                                <form class="p-3">
                                    <div class="m-0">
                                        <div class="input-group">
                                            <input type="text" class="form-control" placeholder="Search ..." aria-label="">
                                            <div class="input-group-append">
                                                <button class="btn btn-primary" type="submit"><i class="fas fa-search"></i></i></button>
                                            </div>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>


                        

                        <div class="dropdown d-inline-block">
                            <button type="button" class="btn header-item waves-effect d-flex align-items-center justify-content-center" id="page-header-user-dropdown"
                                data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <img class="rounded-circle header-profile-user" src="{% static 'assets/images/avatar-img.png' %}" alt="Header Avatar">
                                <span class="d-none d-xl-inline-block ms-1 fw-medium font-size-15 text-white">Admin</span>
                                <i class="arrow-down d-none d-xl-inline-block font-size-15 text-white"></i>
                            </button>
                           <div class="dropdown-menu dropdown-menu-end">
                                <!-- item-->
                                <!-- <a class="dropdown-item" href="\{{user.user_name}}/changepassword/"><i class="fas fa-unlock font-size-15 align-middle text-muted me-1"></i> <span class="align-middle">Change Password</span></a>
                                -->
                             
                                
                                <a class="dropdown-item" href="\{{user.user_name}}/logout/"><i class="fas fa-sign-out-alt font-size-15 align-middle me-1 text-muted"></i><span class="align-middle">Sign out</span></a>
                            </div>
                        </div>

                      
            
                    </div>
                </div>
                <div class="container-fluid">
                    <div class="topnav">
                        {% if user.is_superadmin %}
                        <nav class="navbar navbar-light navbar-expand-lg topnav-menu">
    
                            <div class="collapse navbar-collapse" id="topnav-menu-content">
                                <ul class="navbar-nav">

                                    <li class="nav-item">
                                        <a class="nav-link" href="\{{user.user_name}}/dashboard/">
                                          <i class="fas fa-tachometer-alt me-2"></i>Dashboard
                                        </a>
                                    </li>
    
                                    
    
                                    <li class="nav-item dropdown">
                                        <a class="nav-link dropdown-toggle arrow-none" href="#" id="topnav-pages" role="button">
											<i class="fas fa-stream me-2"></i>Timelines <div class="arrow-down"></div>
                                        </a>
                                        <div class="dropdown-menu" aria-labelledby="topnav-pages">

                                          
                                            <a href="\{{user.user_name}}/posts/" class="dropdown-item"><div class="arrow-right"></div>Posts</a>
											   <a href="\{{user.user_name}}/stories/" class="dropdown-item">Stories</a>
											  <a href="\{{user.user_name}}/banners/" class="dropdown-item">Banners</a>
											
											
                                        </div>
                                    </li>
										<li class="nav-item dropdown">
                                        <a class="nav-link dropdown-toggle arrow-none" href="#" id="topnav-pages" role="button">
                                            <i class="fas fa-walking me-2"></i>Padayatra <div class="arrow-down"></div>
                                        </a>
                                        <div class="dropdown-menu" aria-labelledby="topnav-pages">

                                            <a href="\{{user.user_name}}/schedulepadayatra/" class="dropdown-item">Schedule Padayatra</a>
                                            <a href="\{{user.user_name}}/listpadayatra/" class="dropdown-item">List of Padayatra</a>
											
                                        </div>
                                    </li>
                                     <li class="nav-item">
                                        <a class="nav-link" href="\{{user.user_name}}/users/">
                                            <i class="fa fa-users me-2"></i> Users
                                        </a>
                                    </li>
    
    
                                    
                                    
    
                                </ul>
                            </div>
                        </nav>
                        {% elif user.is_manager %}
                        <nav class="navbar navbar-light navbar-expand-lg topnav-menu">
    
                            <div class="collapse navbar-collapse" id="topnav-menu-content">
                                <ul class="navbar-nav">

                                    <li class="nav-item">
                                        <a class="nav-link" href="\{{user.user_name}}/dashboard/">
                                          <i class="fas fa-tachometer-alt me-2"></i>Dashboard
                                        </a>
                                    </li>
    
                                    
    
                                    <li class="nav-item dropdown">
                                        <a class="nav-link dropdown-toggle arrow-none" href="#" id="topnav-pages" role="button">
											<i class="fas fa-stream me-2"></i>Timelines <div class="arrow-down"></div>
                                        </a>
                                        <div class="dropdown-menu" aria-labelledby="topnav-pages">

                                          
                                            <a href="\{{user.user_name}}/posts/" class="dropdown-item"><div class="arrow-right"></div>Posts</a>
											   <a href="\{{user.user_name}}/stories/" class="dropdown-item">Stories</a>
											  <a href="\{{user.user_name}}/banners/" class="dropdown-item">Banners</a>
											
											
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </nav>
                        {% endif %}
                    </div>
                </div>
            </header>
    


            <!-- ============================================================== -->
            <!-- Start right Content here -->
            <!-- ============================================================== -->
            <div class="main-content">

                <div class="page-content">
                    <div class="container-fluid">

                      

                        
						  <div class="row">
                            <div class="col-12">
                                <div class="card">
                                    <div class="card-body">
                                        <h4 class="card-title mb-3 color-red-tdp">Add Posts</h4>
                                       
                                        <form class="needs-validation" method="POST" action="\feed/upload/" enctype="multipart/form-data">
                                            {% csrf_token %}
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="mb-3">
                                                        <label class="form-label" for="">Title<span style="color:red;padding-left:5px;">*</span></label>
                                                        <input type="text" class="form-control" id="title" placeholder="Enter Title" value="" >
                                                        
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="mb-3">
                                                        <label class="form-label" for="">Select Category</label>
                                                          <select class="select2 form-control select2-multiple" id="category" multiple="multiple" data-placeholder="Choose ...">
                                                            <optgroup >
                                                                <option value="FANS">Fans</option>
                                                                <option value="NLY">NL Yatra</option>
																<option value="EXC">Exclusive</option>
                                                            </optgroup>
                                                          
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
											 <div class="row">
                                                <div class="col-md-12">
                                                    <div class="mb-3">
                                                        <label class="form-label" for="">Title (Telugu)<span style="color:red;padding-left:5px;">*</span></label>
                                                        <input type="text" id="telugu-title" class="form-control" placeholder="శీర్షికను నమోదు చేయండి" value="" >
                                                        
                                                    </div>
                                                </div>
                                                
                                            </div>
											 <div class="row">
                                                
                                                <div class="col-md-12">
                                                    <div class="mb-3">
                                                        <label class="form-label" for="">Tags</label>
                                                       <input type="text" id="tags" class="form-control p-4" data-role="tagsinput" data-placeholder="enter tags ..."/>
                                                    </div>
                                                </div>
                                               
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-12">
                                                    <div class="mb-3">
                                                        <label class="form-label" for="">Short Description</label>
                                                      
	<div id="editparent">
		<div id="editControls">
			<div class="btn-group">
				<a class="btn btn-xs btn-default" data-role="undo" href="#" title="Undo"><i class="fa fa-undo"></i></a>
				<a class="btn btn-xs btn-default" data-role="redo" href="#" title="Redo"><i class="fas fa-redo"></i></i></a>
			</div>
			<div class="btn-group">
				<a class="btn btn-xs btn-default" data-role="bold" href="#" title="Bold"><i class="fa fa-bold"></i></a>
				<a class="btn btn-xs btn-default" data-role="italic" href="#" title="Italic"><i class="fa fa-italic"></i></a>
				<a class="btn btn-xs btn-default" data-role="underline" href="#" title="Underline"><i class="fa fa-underline"></i></a>
		
			</div>
			<div class="btn-group">
			
				<a class="btn btn-xs btn-default" data-role="insertUnorderedList" href="#" title="Unordered List"><i class="fa fa-list-ul"></i></a>
				<a class="btn btn-xs btn-default" data-role="insertOrderedList" href="#" title="Ordered List"><i class="fa fa-list-ol"></i></a>
			</div>
			<div class="btn-group">
				<a class="btn btn-xs btn-default" data-role="h1" href="#" title="Heading 1"><i class="fas fa-heading"></i><sup>1</sup></a>
				<a class="btn btn-xs btn-default" data-role="h2" href="#" title="Heading 2"><i class="fas fa-heading"></i><sup>2</sup></a>
			
			</div>
		</div>
		<div id="editor" contenteditable></div>
		<textarea  id="editorCopy" name="desc"  style="display:none;" ></textarea>
	</div>
  
                                                    </div>
                                                </div>
												<div class="col-md-12">
                                                    <div class="mb-3">
                                                        <label class="form-label" for="">Short Description (Telugu)</label>
                                                      <textarea id="telugu-description" class="form-control p-4" placeholder="పోస్ట్ గురించి వివరించండి"></textarea>
	
                                                    </div>
                                                </div>
                                               
                                            </div>
                                            <div class="row">
                                                
                                                <div class="col-md-12">
                                                    <div class="mb-3">
                                                        <label class="form-label" for="">Upload Post Images</label>
                                                          <div class="upload__box">
														  <div class="upload__btn-box">
															<label class="upload__btn">
															  <p>Select files to upload</p>
															  <input type="file" multiple="" name="files" id="images" data-max_length="20" class="upload__inputfile" >
															</label>
														  </div>
														  <div class="upload__img-wrap"></div>
														</div>
														<p class="help-block" style="font-size: 12px; padding-top: 6px;">Image Dimensions:(width-1080px, Height-1920px, Maximum upload size 5MB)</p>
                                                    </div>
                                                </div>
                                               
                                            </div>
											<div class="row">
                                                
                                                <div class="col-md-12">
                                                    <div class="mb-3">
                                                        <label class="form-label" for="">Upload Post Videos</label>
                                                       <input id="video" type="file" class="form-control"  value="" accept="video/*">
														<p class="help-block" style="font-size: 12px; padding-top: 6px;">Video Dimensions:(1080px*540px or 1920px*1080, Maximum upload size 50MB)</p>
                                                    </div>
                                                </div>
                                               
                                            </div>
                                            <button class="btn mt-3 bgcolor-red-tdp text-white" type="submit">Submit Post</button>
                                        </form>
                                    </div>
                                </div>
                            </div> <!-- end col -->
                        </div> <!-- end row -->
                        
                        
                    </div> <!-- container-fluid -->
                </div>
                <!-- End Page-content -->

                
                <footer class="footer">
                    <div class="container-fluid">
                        <div class="row">
                            <div class="col-sm-12 text-center">
                                <script>document.write(new Date().getFullYear())</script> © Telugu Desam Party Padayatra.
                            </div>
                            
                        </div>
                    </div>
                </footer>
            </div>
            <!-- end main content-->

        </div>
        <!-- END layout-wrapper -->

        

       

        <!-- JAVASCRIPT -->
        <script src="{% static 'assets/libs/jquery/jquery.min.js' %}"></script>
        <script src="{% static 'assets/libs/bootstrap/js/bootstrap.bundle.min.js' %}"></script>
        <script src="{% static 'assets/libs/metismenu/metisMenu.min.js' %}"></script>
        <script src="{% static 'assets/libs/simplebar/simplebar.min.js' %}"></script>
        <script src="{% static 'assets/libs/node-waves/waves.min.js' %}"></script>
        <script src="{% static 'assets/libs/waypoints/lib/jquery.waypoints.min.js' %}"></script>
        <script src="{% static 'assets/libs/jquery.counterup/jquery.counterup.min.js' %}"></script>
		
		          <!-- plugins -->
        <script src="{% static 'assets/libs/select2/js/select2.min.js' %}"></script>
          <!-- init js -->
        <script src="{% static 'assets/js/pages/form-advanced.init.js' %}"></script>
       
			 <script src="https://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.9/summernote-bs4.js"></script>
        <!-- App js -->
      
		<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-tagsinput/0.8.0/bootstrap-tagsinput.min.js"></script>

             
        
                <script src="{% static 'assets/js/app.js' %}"></script>
            
  <script>
    $(function () {
      $('input')
        .on('change', function (event) {
          var $element = $(event.target);
          var $container = $element.closest('.example');

          if (!$element.data('tagsinput')) return;

          var val = $element.val();
          if (val === null) val = 'null';
          var items = $element.tagsinput('items');

          $('code', $('pre.val', $container)).html(
            $.isArray(val)
              ? JSON.stringify(val)
              : '"' + val.replace('"', '\\"') + '"'
          );
          $('code', $('pre.items', $container)).html(
            JSON.stringify($element.tagsinput('items'))
          );
        })
        .trigger('change');
    });
  </script>
<script>
jQuery(document).ready(function () {
  ImgUpload();
});

function ImgUpload() {
  var imgWrap = "";
  var imgArray = [];

  $('.upload__inputfile').each(function () {
    $(this).on('change', function (e) {
      imgWrap = $(this).closest('.upload__box').find('.upload__img-wrap');
      var maxLength = $(this).attr('data-max_length');

      var files = e.target.files;
      var filesArr = Array.prototype.slice.call(files);
      var iterator = 0;
      filesArr.forEach(function (f, index) {

        if (!f.type.match('image.*')) {
          return;
        }

        if (imgArray.length > maxLength) {
          return false
        } else {
          var len = 0;
          for (var i = 0; i < imgArray.length; i++) {
            if (imgArray[i] !== undefined) {
              len++;
            }
          }
          if (len > maxLength) {
            return false;
          } else {
            imgArray.push(f);

            var reader = new FileReader();
            reader.onload = function (e) {
              var html = "<div class='upload__img-box'><div style='background-image: url(" + e.target.result + ")' data-number='" + $(".upload__img-close").length + "' data-file='" + f.name + "' class='img-bg'><div class='upload__img-close'></div></div></div>";
              imgWrap.append(html);
              iterator++;
            }
            reader.readAsDataURL(f);
          }
        }
      });
    });
  });

  $('body').on('click', ".upload__img-close", function (e) {
    var file = $(this).parent().data("file");
    for (var i = 0; i < imgArray.length; i++) {
      if (imgArray[i].name === file) {
        imgArray.splice(i, 1);
        break;
      }
    }
    $(this).parent().parent().remove();
  });
}
</script>

<script>
jQuery(document).ready(function($) {
	/** ******************************
		* Simple WYSIWYG
		****************************** **/
	$('#editControls a').click(function(e) {
		e.preventDefault();
		switch($(this).data('role')) {
			case 'h1':
			case 'h2':
			case 'h3':
			case 'p':
				document.execCommand('formatBlock', false, $(this).data('role'));
				break;
			default:
				document.execCommand($(this).data('role'), false, null);
				break;
		}
		var textval = $("#editor").html();
		$("#editorCopy").val(textval);
	});

	$("#editor").keyup(function() {
		var value = $(this).html();
		$("#editorCopy").val(value);
	}).keyup();
	
	$('#checkIt').click(function(e) {
		e.preventDefault();
		alert($("#editorCopy").val());
	});
});
</script>


 <script>
    let dataarray=[]
    let arr=[]
    $('form').on('submit',function(e){
        e.preventDefault()
        alert()
    })
    $('#images').on('change',function(e){
    const images=e.target.files
    console.log(images[0])
    const reader=new FileReader()
    reader.onload=function(){
        const file_extension=reader.result.split(',')[0].split(';')[0].split('/')[1]
        const file_type=reader.result.split(',')[0].split(';')[0].split('/')[0].split(':')[1]
        let data=reader.result.split(',')[1]
        dataarray.push(file_extension)
        console.log("data aray===============",dataarray)
        dataarray.push(file_type)
        console.log("data aray===============",dataarray)
        dataarray.push(reader.result.split(',')[1])
        console.log(dataarray.length)
        console.log(dataarray)
    
    }
    reader.readAsDataURL(images[0])
    // console.log("data array is",dataarray)
        })
        $('form').on('submit',function(e){
            e.preventDefault()

            senddata()

        })
            arr.push(JSON.stringify({'file_extension':dataarray[0],'file_type':dataarray[1],'data':dataarray[2]}))
          console.log(arr)
       
            // formdata.append('files',arr[0])
            async function senddata(){
                const formdata=new FormData()
            // formdata.append('title',$('#title').val())
            // formdata.append('catgeory',$('#category').val())
            // formdata.append('tags',$('#tags').val())
            // formdata.append('telugu-title',$('#telugu-title').val())
            // formdata.append('eng-description',$('#editorCopy').val())
            // formdata.append('video',$('#video').val())

       formdata.append('file_extension',dataarray[0])
       formdata.append('Data',dataarray[2])

            formdata.append('file_type',dataarray[1])
            var upload_file={"files":[{

            "file_extension":dataarray[0],
            "file_type":dataarray[1],
            "data":dataarray[2],
            }
            ]}
            
          console.log("data is********************",upload_file)
         
            const response=await fetch('http://localhost:8000/feed/upload-file',{
                method:'post',
                body:formdata
            })
            var data=await response.json()
            console.log(data)
        }
        </script> 

        <script>

            async function srcToFile(e,context, asset) {
         const files = e.target.files.fileList;
         let results = [];
         for (let i = 0; i < files.length; i++) {
             const file = files[i];
              const data = file.data;
              const name = file.name;
              const mimeType = file.type;

             await fetch(data)
                  .then(function(res) {
                      const r = res.arrayBuffer();
                      console.warn('resource ', r);
                      return r;
                  })
                  .then(function(buf) {
                      console.warn('buffer: ', [buf]);
                      const fileData = {data:[buf], name:name, type:mimeType};
                      results.push(fileData);
                      console.warn('results of file: ', fileData);
                  });
          }
         console.warn(results);
         return results;
     }
        </script>
    </body>
</html>
